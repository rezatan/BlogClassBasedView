{% extends "base.html" %}
{% load static %}

{% block page_title %}
    Manage Article
{% endblock page_title %}

{% block contents %}
<link rel="stylesheet" type="text/css" href="{% static 'switch.css' %}">
    <h1>Manage Article</h1>
	{% if perms.article.add_article %}
    <a class="btn btn-primary btn-block" href="{% url 'article:create' %}">Add article</a>
	{% endif %}
    <table class="table mt-4">
	  <thead class="thead-dark">
	    <tr>
	      <th scope="col">#</th>
	      <th scope="col">Title</th>
	      <th scope="col">Category</th>
	      <th scope="col">Published</th>
		  {% if perms.article.change_article %}
		  <th scope="col">Action</th>
		  {% endif %}
		  {% if perms.article.delete_article %}
		  <th></th>
		  {% endif %}
		  <th>Publish</th>
	    </tr>
	  </thead>
	  <tbody>
	    {% for article in article_list %}
	    <tr>
	      <th scope="row">{{forloop.counter}}</th>
	      <td>{{article.title}}</td>
	      <td>{{article.category}}</td>
	      <td>{{article.published}}</td>
		   {% if perms.article.change_article %}
	      <td>
			<a class="btn btn-warning" href="{% url 'article:update' article.id %}">Edit</a>
		  </td>
		  {% endif %}
		  {% if perms.article.delete_article %}
		  <td>
	      	<a class="btn btn-danger" href="{% url 'article:delete' article.id %}">Delete</a>
	      </td>
		  {% endif %}
	
		  <td>
			<form method="post" action="{% url 'article:manage' %}">
				{% csrf_token %}
				<label class="toggle-switch">
				{% if perms.article.publish_article %}
				<button type="submit" name="article_id" value="{{ article.id }}"></button>
				{% endif %}
				<input type="checkbox" {% if article.is_published %} checked {% if not perms.article.publish_article %}
				disabled
				{% endif %}{% endif %}>
				<div class="toggle-switch-background">
					<div class="toggle-switch-handle" ></div>
				</div>
				</label>
				{% comment %} <input type="hidden" name="article_id" value="{{ article.id }}">
				{% if article.is_published %}
					<input type="submit" value="Unpublish">
				{% else %}
					<input type="submit" value="Publish">
				{% endif %} {% endcomment %}
			</form>
		</td>
	    </tr>
	    {% endfor %}
	  </tbody>
	</table>

{% endblock contents %}